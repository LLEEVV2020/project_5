<!DOCTYPE html>
<html lang="ru" class="page">

<head>
  @include('partials/head.html')
</head>

<body class="page__body">
  <div class="site-container">


    @include('partials/header2.html')
    @include('partials/menu.html')

    <main class="main">

    </main>


    <div class="modal_proverka_cifr modal fade" id="proverka_cifr" tabindex="-1" aria-labelledby="proverka_cifrLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content modal-content1">



          <h2>Неверный код!
          </h2>
          <p>Введите правильный код! У вас всё получится!</p>

          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><img src="img/svg/icon-btn.svg" alt="">
            Закрыть</button>

        </div>
      </div>
    </div>

    <button style="display: none;" type="button" class="btn btn-primary btn-proverka-cifr" data-bs-toggle="modal" data-bs-target="#proverka_cifr">
      ПРОВЕКРКА
    </button>

    @include('partials/foot.html')

    <script src="lib/input.js"></script>

    <script>

      $('input').keydown(function(e){
        $(this).val('');
      });

      $('input').keyup(function(e){
        var $wrap = $(this).closest('.pincode');
        var $inputs = $wrap.find('input[type="number"]');
        var val = $(this).val();

        // Ввод только цифр
        if(val == val.replace(/[0-9]/, '')) {
          $(this).val('');
          return false;
        }

        // Передача фокуса следующему innput
        $inputs.eq($inputs.index(this) + 1).focus();

        // Заполнение input hidden
        var fullval = '';
        $inputs.each(function(){
          fullval = fullval + (parseInt($(this).val()) || '0');
        });
        $wrap.find('input[type="hidden"]').val(fullval);
      });
////////////////////////////////////////

      let cifri_input = document.querySelectorAll('.cifri-input');

      let text1 = "";
      for (let input of cifri_input) {

        //console.log(input);
        input.addEventListener('click', function (event) {

          text1 = this.value;
        });
      }


      let btn1 = document.querySelector('.btn');
      let name1_paket = "";

      btn1.addEventListener('click', function (event) {
        //for (let input of cifri_input) {
        //  text1 = text1 + input.value;
        //}

        let pincodes = document.querySelector('.pincodes');
        text1 = pincodes.value;

        let url1_paket = "4.html";
        //alert("hgg");
        //debugger;

          // сделать условие флаг

        let text1Fllag = false;
        var storedСodearr = JSON.parse(localStorage.getItem("codearr"));
        for (let i = 0; i < storedСodearr.length; i++ ) {
          if(storedСodearr[i] === text1 && text1.length !== 0){
            text1Fllag = true;


          }
        }

       // debugger;
        if ( text1Fllag ) {


              var storedNames = JSON.parse(localStorage.getItem("codearr"));
              let flag_continue = false;



              for (let i = 0; i < storedNames.length; i++ ) {
                //console.log(storedNames[i]);
                if(text1 == storedNames[i]){

                  storedNames[i] = "";
                  localStorage.setItem("codearr", JSON.stringify(storedNames));
                }

                if(flag_continue){
                  continue;
                }


                flag_continue = true;

      /*
                  4529
                  9163
                  8437
                  0375
                  4826
      */

                  let flag_code1_paket = localStorage.getItem('code1_paket');
                  // if (flag_code1_paket === null || flag_code1_paket === "4529") {

                  //if (flag_code1_paket === "9163") {
                    //text1
                    let code1 = "9163";
                    localStorage.removeItem('code1_paket');
                    localStorage.setItem('code1_paket', JSON.stringify(+code1));

                  // }


                    name1_paket = {
                      name1: 'jjhhhgf',
                      age: 3333,
                      url: url1_paket,
                      code1: text1
                    };

                    localStorage.removeItem('name1_paket');
                    localStorage.setItem('name1_paket', JSON.stringify(name1_paket));


                    let flag_url2_paket = localStorage.getItem('url2_paket');
                    if(flag_url2_paket === null){

                      let url2_paket  = "4.html";
                      localStorage.removeItem('url2_paket');
                      localStorage.setItem('url2_paket', url2_paket);
                    }
                    console.log(text1);
              }

              const url2_paket2 = "4.html";
              localStorage.removeItem('url2_paket');
              //localStorage.setItem('name1_link1', JSON.stringify(name1_link1)); menu2.html
              localStorage.setItem('url2_paket', url2_paket2);

              localStorage.setItem('5paket_pin_2', text1);

            } else{

              let cifri_input2 = document.querySelectorAll('.cifri-input');
              for (let input of cifri_input2) {

                input.value = "";

              }

              if ( text1 === "4529" ||
                text1 === "9163"  ||
                text1 === "8437"  ||
                text1 === "0375"  ||
                text1 === "4826"
              ){

                //alert("Данный код вы ужу вводили!");


                let modal_content1_h2 = document.querySelector(".modal-content1 h2");
                let modal_content1_p = document.querySelector(".modal-content1 p");
                modal_content1_h2.innerHTML = "Использо- ванный код!";
                modal_content1_p.innerHTML = "Введите новый код! У вас всё получится!";

                document.querySelector(".btn-proverka-cifr").click();

              } else {

                let modal_content1_h2 = document.querySelector(".modal-content1 h2");
                let modal_content1_p = document.querySelector(".modal-content1 p");
                modal_content1_h2.innerHTML = "Неверный код!";
                modal_content1_p.innerHTML = "Введите правильный код! У вас всё получится!";

                document.querySelector(".btn-proverka-cifr").click();
                //alert("Введите правильный код!");

              }

            }





       // debugger;
        /*let flag_code1_paket = localStorage.getItem('code1_paket');
        // if (flag_code1_paket === null || flag_code1_paket === "4529") {
        if (flag_code1_paket === "9163") {
          //text1
          let code1 = "9163";
          localStorage.removeItem('code1_paket');
          localStorage.setItem('code1_paket', JSON.stringify(+code1));
        }*/

        //console.log(cifri_input);

        localStorage.removeItem('x5paket_katok_qw_screen_puzzle_start');
        localStorage.setItem('x5paket_katok_qw_screen_puzzle_start', "x5paket_katok_qw_screen_puzzle_start");



      });



      //const name1_link1 = "menu2.html";
      //localStorage.removeItem('name1_link1');
      //localStorage.setItem('name1_link1', JSON.stringify(name1_link1)); menu2.html
      //localStorage.setItem('name1_link1', name1_link1);


      localStorage.removeItem('x5paket_katok_qw_screen_puzzle_map');
      localStorage.setItem('x5paket_katok_qw_screen_puzzle_map', "x5paket_katok_qw_screen_puzzle_map");


    </script>



  </div>
</body>

</html>
